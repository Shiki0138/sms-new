# 美容サロン管理システム - ライトプラン実装タスク

## 実装計画概要

このタスクリストは、美容サロン管理システムのライトプランを段階的に実装するための具体的なコーディングタスクです。各タスクは前のタスクの成果物を基に構築され、テスト駆動開発を重視した実装を行います。

## 実装タスク

- [x] 1. プロジェクト基盤とセットアップ
  - React + TypeScript + Vite プロジェクトの初期化
  - 必要な依存関係のインストール（TailwindCSS、React Router、React Query等）
  - ESLint、Prettier、Husky の設定
  - GitHub リポジトリ作成と Vercel 自動デプロイ設定
  - _要件: 10.1, 10.2, 10.3_

- [x] 2. Supabase プロジェクト設定とデータベース構築
  - Supabase プロジェクト作成と環境変数設定
  - データベーススキーマの実装（tenants, customers, reservations, service_menus, business_settings テーブル）
  - Row Level Security (RLS) ポリシーの実装
  - テストデータの投入
  - _要件: 1.4, 8.2, 8.3_

- [x] 3. 基本認証システムの実装
  - Supabase Auth クライアント設定
  - AuthContext の実装（ユーザー状態管理、テナント情報取得）
  - ログイン・サインアップ・パスワードリセットコンポーネントの作成
  - 認証ガードとプライベートルートの実装
  - _要件: 1.1, 1.2, 1.3, 1.5_

- [x] 4. テナント管理とプラン制限システム
  - TenantContext の実装（テナント情報管理）
  - PlanContext の実装（プラン制限チェック機能）
  - プラン制限モーダルコンポーネントの作成
  - 使用状況追跡システムの実装
  - _要件: 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7_

- [ ] 5. 共通UIコンポーネントとレイアウト
  - 基本UIコンポーネント（Button, Input, Modal, Toast）の実装
  - レスポンシブレイアウトコンポーネントの作成
  - ナビゲーションメニューの実装
  - エラーバウンダリとローディングスピナーの実装
  - _要件: 9.1, 9.2, 9.3, 9.4, 9.5, 9.6_

- [ ] 6. 顧客管理システムの実装（外部連携対応）
  - 顧客データモデルとバリデーションの実装（LINE ID、Instagram ID追加）
  - 顧客一覧表示コンポーネント（検索・ソート・フィルタリング機能付き）
  - 顧客登録・編集フォームの実装（連絡手段優先順位設定）
  - 顧客詳細画面と来店履歴・メッセージ履歴表示の実装
  - プラン制限（100件制限）の適用
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 3.7_

- [ ] 7. サービスメニュー管理システム
  - メニューデータモデルとCRUD操作の実装
  - メニュー一覧表示とカテゴリ別整理機能
  - メニュー作成・編集フォームの実装
  - メニューの有効/無効切り替え機能
  - 予約作成時のメニュー選択機能との連携
  - _要件: 4.1, 4.2, 4.3, 4.4, 4.5_

- [ ] 8. 営業時間・定休日設定システム
  - 営業設定データモデルの実装
  - 曜日別営業時間設定コンポーネント
  - 定休日設定コンポーネント（チェックボックス形式）
  - 設定変更の即座保存とリアルタイム反映機能
  - 店舗基本情報管理フォーム
  - _要件: 5.1, 5.2, 5.3, 5.6, 5.7, 5.8_

- [ ] 9. 予約管理システム - データ層
  - 予約データモデルとバリデーションの実装
  - 予約CRUD操作のカスタムフック作成
  - 営業時間・定休日との整合性チェック機能
  - 予約重複チェック機能の実装
  - 月間予約数制限（50件）の実装
  - _要件: 2.6, 5.4, 5.5, 6.3_

- [ ] 10. 予約管理システム - カレンダーUI
  - カレンダー表示コンポーネント（日・週・月表示モード）
  - 予約の視覚的表示とステータス別色分け
  - 定休日の視覚的区別表示
  - レスポンシブ対応（デスクトップ・タブレット・スマホ）
  - タッチ操作対応の実装
  - _要件: 2.1, 5.5, 9.1, 9.2, 9.5_

- [ ] 11. 予約作成・編集システム
  - 予約作成フォームの実装（顧客選択、日時設定、メニュー選択）
  - 予約編集・削除機能の実装
  - 予約ステータス管理（仮予約・確定・完了・キャンセル・無断キャンセル）
  - 営業時間外予約の防止機能
  - 確認ダイアログとバリデーション
  - _要件: 2.2, 2.3, 2.4, 2.5, 5.4_

- [ ] 12. 外部API連携システムの実装
  - LINE Messaging API連携の実装
  - Instagram Graph API連携の実装
  - Google Calendar API連携の実装
  - ホットペッパーCSVインポート機能の実装
  - API設定画面の実装（認証・設定管理）
  - API エラーハンドリングとリトライ機能
  - _要件: 10.1, 10.2, 10.3, 10.4, 10.5, 10.6, 10.7_

- [ ] 13. メッセージ管理システムの実装
  - メッセージデータモデルとスキーマの実装
  - メッセージ受信システム（LINE・Instagram・メール）
  - メッセージ一覧・スレッド表示コンポーネント
  - メッセージ送信機能（チャネル別）
  - 優先順位に基づく統合表示機能
  - メッセージ履歴管理とフィルタリング
  - _要件: 8.1, 8.2, 8.3, 8.4, 8.6, 8.8_

- [ ] 14. AI返信支援システムの実装
  - OpenAI API連携の実装
  - 顧客コンテキスト分析機能
  - AI返信生成ロジックの実装
  - 返信候補表示UIの実装
  - 返信内容のカスタマイズ機能
  - AI返信の学習・改善機能
  - _要件: 8.5_

- [ ] 15. 自動リマインダーシステムの実装
  - リマインダーテンプレート管理機能
  - リマインダージョブスケジューリング
  - 自動送信システム（1週間前・3日前・来店後）
  - リマインダー設定画面の実装
  - 送信失敗時の代替手段実装
  - リマインダー履歴とログ管理
  - _要件: 9.1, 9.2, 9.3, 9.4, 9.5, 9.6, 9.7_

- [ ] 16. ダッシュボード機能の実装（メッセージ統合）
  - 本日の予約一覧（タイムライン表示）
  - 本日の売上合計表示
  - メッセージ通知システム（新着メッセージ・返信待ち）
  - 重要通知システム（新規予約・キャンセル）
  - クイックアクション（予約追加・顧客検索・メッセージ返信）
  - 次の予約の強調表示機能
  - _要件: 7.1, 7.2, 7.3, 7.4, 7.5, 8.7_

- [ ] 17. 美容師向けプレミアムデザインシステムの実装
  - Atlassian Design System参考のデザイントークン実装
  - 美容業界向けカラーパレット（ローズゴールド系）の適用
  - エレガントなタイポグラフィとフォント設定
  - 上品で柔らかい影とアニメーション効果
  - 心地よいマイクロインタラクションの実装
  - _要件: 12.4, 12.7, 12.8_

- [ ] 18. スマホ操作性最適化の実装
  - タッチフレンドリーなコンポーネント（44px以上のタップエリア）
  - スワイプジェスチャー対応（カレンダー・メッセージ画面）
  - フローティングアクションボタンの実装
  - スマホ専用ナビゲーション（ボトムタブ）
  - ピンチズーム対応とタッチ操作最適化
  - _要件: 12.1, 12.2, 12.5_

- [ ] 19. レスポンシブデザインの完全実装
  - デバイス別最適化レイアウト（スマホ・タブレット・PC）
  - 美しいプロポーション維持の自動調整
  - セーフエリア対応（iPhone等のノッチ対応）
  - ブレークポイント戦略の実装
  - デバイス別コンポーネント切り替え
  - _要件: 12.3_

- [ ] 20. エラーハンドリングとログシステム
  - グローバルエラーハンドリングシステムの実装
  - エラー分類と美容師向けエレガントなエラーメッセージ
  - 構造化ログシステムの実装
  - Supabase API エラーの適切な処理
  - リトライ機能とフォールバック処理
  - _要件: 12.6, 13.3, 13.5, 13.7_

- [ ] 21. パフォーマンス最適化
  - React.memo による再レンダリング防止の実装
  - useMemo による計算結果キャッシュの実装
  - 画像遅延読み込みの実装
  - データベースクエリの最適化
  - バンドルサイズの最適化
  - _要件: 13.4_

- [ ] 22. テスト実装
  - 認証システムのユニットテスト
  - 予約管理システムの統合テスト
  - 顧客管理システムのユニットテスト
  - メッセージ管理システムのテスト
  - プラン制限機能のテスト
  - エラーハンドリングのテスト
  - _要件: 全要件のテストカバレッジ_

- [ ] 23. セキュリティ強化
  - HTTPS 強制設定
  - 環境変数の適切な管理
  - セッション管理の強化
  - XSS・CSRF 対策の実装
  - データ入力のサニタイゼーション
  - 外部API認証情報の暗号化
  - _要件: 11.1, 11.4, 11.5, 11.6_

- [ ] 24. ユーザビリティテストと改善
  - 美容師向けユーザビリティテストの実施
  - フィードバックに基づくUI/UX改善
  - アクセシビリティ対応の実装
  - 操作性の最適化
  - ヘルプドキュメントの作成
  - _要件: 12.4, 12.5_

- [ ] 25. データ移行とバックアップシステム
  - 既存データのインポート機能
  - 定期バックアップシステムの実装
  - データエクスポート機能
  - 災害復旧手順の策定
  - データ整合性チェック機能
  - _要件: 11.3_

- [ ] 26. 本番環境デプロイ準備
  - 本番用環境変数の設定
  - Vercel デプロイ設定の最適化
  - エラー監視システムの設定
  - パフォーマンス監視の設定
  - バックアップ戦略の実装
  - _要件: 11.3, 13.1, 13.2, 13.4_

- [ ] 27. 最終統合テストとリリース準備
  - 全機能の統合テスト実施
  - パフォーマンステストの実施
  - セキュリティテストの実施
  - ブラウザ互換性テスト
  - モバイルデバイステスト
  - リリースノートの作成
  - _要件: 全要件の最終確認_