# 月次セキュリティ監査チェックリスト

**実施日**: ___________  
**実施者**: ___________

## 1. 脆弱性スキャン ⚡

### npm 監査
```bash
npm audit
```
- [ ] 実行完了
- [ ] Critical 脆弱性: _____ 件
- [ ] High 脆弱性: _____ 件
- [ ] 修正実行: `npm audit fix`

### 依存関係更新
```bash
npm outdated
```
- [ ] 更新が必要なパッケージ数: _____ 件
- [ ] 更新実行完了

## 2. Supabase セキュリティ確認 🔐

### RLS (Row Level Security)
```sql
-- 検証スクリプト実行
-- /salon-light-plan/supabase/migrations/verify_security_fixes.sql
```
- [ ] 全テーブルで RLS 有効: Yes / No
- [ ] ポリシー確認完了
- [ ] 不適切なポリシー: _____ 件

### 関数セキュリティ
- [ ] search_path 設定確認完了
- [ ] SECURITY DEFINER 適切に設定: Yes / No
- [ ] 問題のある関数: _____ 件

### 認証設定
- [ ] OTP 有効期限: _____ 秒（推奨: 1800）
- [ ] パスワード最小長: _____ 文字（推奨: 8）
- [ ] HIBP チェック有効: Yes / No
- [ ] MFA 有効: Yes / No

## 3. ログ分析 📊

### 認証ログ
- [ ] 失敗ログイン回数（過去30日）: _____ 件
- [ ] 異常なパターン検出: Yes / No
- [ ] ブロックした IP: _____ 件

### データアクセスログ
- [ ] 大量データ取得の検出: Yes / No
- [ ] 通常時間外のアクセス: Yes / No
- [ ] 不審なクエリパターン: Yes / No

## 4. バックアップ確認 💾

- [ ] 自動バックアップ動作確認
- [ ] 最新バックアップ日時: ___________
- [ ] リストアテスト実施: Yes / No

## 5. アクセス権限監査 👥

### データベースユーザー
- [ ] 不要なユーザー削除: _____ 件
- [ ] 権限の見直し完了: Yes / No

### API キー
- [ ] 未使用キーの無効化: _____ 件
- [ ] キーローテーション実施: Yes / No

## 6. セキュリティアップデート 🔄

- [ ] Supabase アップデート確認
- [ ] OS セキュリティパッチ適用
- [ ] SSL 証明書有効期限確認（残り _____ 日）

## 7. インシデント記録 🚨

過去30日のインシデント:
1. ___________
2. ___________
3. ___________

## 8. 改善アクション 📝

優先度高:
1. ___________
2. ___________

優先度中:
1. ___________
2. ___________

## 9. 次回監査予定 📅

日付: ___________
担当者: ___________

---

## 監査結果サマリー

- **総合評価**: 🟢 良好 / 🟡 要注意 / 🔴 要対応
- **前回からの改善点**: ___________
- **次回までの課題**: ___________

**署名**: ___________  
**承認者**: ___________